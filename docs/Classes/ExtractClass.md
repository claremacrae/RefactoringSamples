<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/Classes/mdsource/ExtractClass.source.md
To change this file edit the source file and then execute ./run_markdown_templates.sh.
-->

# Extract Class

[Top](../README.md) / [Classes](./README.md) / **Extract Class**

<!-- toc -->
## Contents

  * [Summary](#summary)
  * [Context](#context)
  * [See Also](#see-also)
  * [Steps to improve the code](#steps-to-improve-the-code)
  * [Example](#example)
    * [Code](#code)
    * [UML](#uml)<!-- endToc -->

 <!-- include: ExtractClass.description. path: /RefactoringSamples/Before/Classes/ExtractClass.description.include.md -->
## Summary

A class has grown too big, and you want to move some of its fields and/or methods to a new class

## Context

You have a class with some fields and/or methods that you wish to move to a different class.

Perhaps the class is doing too much, and you want to separate out some of its responsibilities.

## See Also

* [Extract Class refactoring](https://www.jetbrains.com/help/resharper/Refactorings__Extract_Class.html) (JetBrains ReSharper)
    * Note that this [is implemented in Rider](https://youtrack.jetbrains.com/issue/RIDER-7903) but is not in the documentation, as of March 2021
* [Extract Class](https://refactoring.com/catalog/extractClass.html) (Refactoring.com)

## Steps to improve the code

* Select the class name, and say "Refactor This" -> "Extract Class"
* Select any fields and/or methods that you want to move
* Enter a name for the extracted class

Notes:

* Any fields in the original class will be replaced by an instance of the new class, and the code updated accordingly. <!-- endInclude -->

## Example

### Code

**Before refactoring**

<!-- snippet: ExtractClass-Before -->
<a id='snippet-extractclass-before'></a>
```cs
public class ExtractClass
{
    private int _concept1;
    private int _concept2;

    public int Concept1Function()
    {
        return _concept1;
    }

    public int Concept2Function()
    {
        return _concept2;
    }
}
```
<sup><a href='/RefactoringSamples/Before/Classes/ExtractClass.cs#L3-L19' title='Snippet source file'>snippet source</a> | <a href='#snippet-extractclass-before' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

**After refactoring**

<!-- snippet: ExtractClass-After -->
<a id='snippet-extractclass-after'></a>
```cs
public class Concept1
{
    private int _concept1;

    public int Concept1Function()
    {
        return _concept1;
    }
}

public class Concept2
{
    private int _concept2;

    public int Concept2Function()
    {
        return _concept2;
    }
}

public class ExtractClass
{
    private readonly Concept1 _concept1 = new Concept1();
    private readonly Concept2 _concept2 = new Concept2();
}
```
<sup><a href='/RefactoringSamples/After/Classes/ExtractClass.cs#L3-L29' title='Snippet source file'>snippet source</a> | <a href='#snippet-extractclass-after' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->

### UML

**Before refactoring**

![ExtractClass - Before](../../uml/Before/Classes/ExtractClass.svg?raw=true)

**After refactoring**

![ExtractClass - After](../../uml/After/Classes/ExtractClass.svg?raw=true)

*[Key](../../uml/Keys/FullKey.svg)*

-----

